FROM python:3.7-alpine3.13

WORKDIR /usr/src/backend
COPY requirements.txt ./
RUN apk add zlib-dev
# Config locale --------------------------------------------------------------------------------------------------------
ENV MUSL_LOCPATH=/usr/local/share/i18n/locales/musl
RUN apk add --update git cmake make musl-dev gcc gettext-dev libintl
RUN cd /tmp && git clone https://gitlab.com/rilian-la-te/musl-locales.git
RUN cd /tmp/musl-locales && cmake . && make && make install
RUN /usr/local/bin/locale -a
ENV LANG=fa_IR.UTF-8 \
    LANGUAGE=fa_IR.UTF-8
# ----------------------------------------------------------------------------------------------------------------------

RUN pip3 install --no-cache-dir -r requirements.txt
COPY . .

CMD ["python", "manage.py", "runserver", "8000"]